<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ゼロからできる！医師が教えるエクセルとチャットGPTを使った働き方改革</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        nav {
            background-color: #f8f8f8;
            padding: 10px;
        }
        nav div {
            margin-bottom: 10px;
        }
        nav a {
            margin: 0 10px;
            text-decoration: none;
            color: #007BFF;
        }
        section {
            margin-bottom: 50px;
        }
        h2 {
            color: #333;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
            overflow-x: auto;
        }
        blockquote {
            background-color: #f9f9f9;
            border-left: 10px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.5em 10px;
        }
        .code-container {
            position: relative;
            margin-bottom: 1em;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>ゼロからできる！<br>医師が教えるエクセルとチャットGPTを使った働き方改革</h1>
    <h2>チャットGPTでエクセルを5倍活用する方法</h2>

    <nav>
        <div><strong>依頼文</strong></div>
        <div>
            <a href="#request-step1">ステップ1</a>
            <a href="#request-step2">ステップ2</a>
            <a href="#request-step3">ステップ3</a>
            <a href="#request-step4">ステップ4</a>
            <a href="#request-step5">ステップ5</a>
            <a href="#request-step6">ステップ6</a>
            <a href="#request-step7">ステップ7</a>
            <a href="#request-step8">ステップ8</a>
            <a href="#request-step9">ステップ9</a>
            <a href="#request-step10">ステップ10</a>
            <a href="#request-step11">ステップ11</a>
            <a href="#request-step12">ステップ12</a>            
        </div>
        <div><strong>コード例</strong></div>
        <div>
            <a href="#code-step1">ステップ1</a>
            <a href="#code-step2">ステップ2</a>
            <a href="#code-step3">ステップ3</a>
            <a href="#code-step4">ステップ4</a>
            <a href="#code-step5">ステップ5</a>
            <a href="#code-step6">ステップ6</a>
            <a href="#code-step7">ステップ7</a>
            <a href="#code-step8">ステップ8</a>
            <a href="#code-step9">ステップ9</a>
            <a href="#code-step10">ステップ10</a>
            <a href="#code-step11">ステップ11</a>
            <a href="#code-step12">ステップ12</a>            
        </div>
    </nav>

    <!-- 依頼文セクション -->
    <section id="request-step1">
        <h2>ステップ1: セルA1に現在の年月を表示する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText1')">コピーする</button>
            <blockquote id="requestText1">
                エクセルで「Sheet1」のセルA1に、現在の年月を表示するマクロを「DisplayCurrentYearMonth」という名前で作りたいです。セルA1からG1までを結合して「YYYY/MM」形式で中央揃えで表示されるようにしてください。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step2">
        <h2>ステップ2: カレンダーの曜日ヘッダーを設定する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText2')">コピーする</button>
            <blockquote id="requestText2">
                エクセルで「Sheet1」のセルA2からG2に、カレンダーの曜日ヘッダー（日、月、火、水、木、金、土）を表示するマクロを「SetCalendarHeaders」という名前で作りたいです。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step3">
        <h2>ステップ3: カレンダーの枠線を設定する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText3')">コピーする</button>
            <blockquote id="requestText3">
                エクセルで「Sheet1」のセルA2からG8に、カレンダーの枠線を引くマクロを「DrawCalendarBorders」という名前で作りたいです。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step4">
        <h2>ステップ4: 1日目をカレンダーに表示する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText4')">コピーする</button>
            <blockquote id="requestText4">
                エクセルで「Sheet1」のセルA1に現在の年月を表示し、セルA2からG2に曜日ヘッダー（日、月、火、水、木、金、土）を設定し、セルA2からG8に枠線を引いています。カレンダーの1日目を適切な位置に表示するマクロを「DisplayFirstDay」という名前で作りたいです。1日目はセルA3から表示します。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step5">
        <h2>ステップ5: 2日目以降を追加する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText5')">コピーする</button>
            <blockquote id="requestText5">
                エクセルで「Sheet1」のセルA1に現在の年月を表示し、セルA2からG2に曜日ヘッダー（日、月、火、水、木、金、土）を設定し、セルA2からG8に枠線を引いています。さらに、1日目は適切な位置に表示されています。この状態から、カレンダーの2日目以降を1日の右から順に追加していくマクロを「AddRemainingDays」という名前で作りたいです。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step6">
        <h2>ステップ6: 土曜日を青、日曜日を赤にする</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText6')">コピーする</button>
            <blockquote id="requestText6">
                エクセルで「Sheet1」のカレンダーの土曜日を青、日曜日を赤に表示するマクロを「ColorWeekends」という名前で作りたいです。曜日ヘッダー（セルA2からG2）も同様に土曜日を青、日曜日を赤にしてください。カレンダーは以下の前提で作成されています。
                <ol>
                    <li>セルA1には現在の年月が表示され、A1からG1までが結合されています。</li>
                    <li>セルA2からG2には曜日（日、月、火、水、木、金、土）が表示されています。</li>
                    <li>カレンダーの日付はセルA3から始まり、適切に配置されています。</li>
                </ol>
                コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step7">
        <h2>ステップ7: 祝日というシートに今年の祝日リストを書く</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText7')">コピーする</button>
            <blockquote id="requestText7">
                エクセルで今年の日本の祝日リストを「祝日」という名前のシートに書き込むマクロを「CreateHolidaySheet」という名前で作成したいです。<br><br>
                
                すでに祝日というシートがある場合は、内容とフォーマットを
                ws.Cells.Clearとws.Cells.ClearFormatsでクリアしてください。<br>
                シートの削除は禁止です。<br>
                祝日リストは、以下の祝日リストを参照してください。<br>
                祝日リストをマクロコード内に直接書き込んでください。<br><br>
                
                祝日リストは、1行目をヘッダーで、<br>
                ・A1は「祝日名」、B1は「日付」と入力<br>
                ・A2以下に祝日名、B2以下に「YYYY/MM/DD」の形式で祝日の日付を入力<br><br>
                
                祝日リストを入力した後に、以下のように書式を調整してください<br>
                ・A1:Bの範囲で「枠線」を付ける<br>
                ・A1:Bの範囲で文字は「中央ぞろえ」にする<br>
                ・A1:Bの範囲で文字が切れないようにA列とB列のセル幅を「AutoFit」で調整<br>
                ・ヘッダーのみ「黄色塗りつぶし」<br><br>
                
                必ず、祝日リストを入力してから、書式を調整する順にして下さい。<br><br>
    
                <b>祝日リスト:</b><br>
                名称 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 日付<br>
                元日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/1/1<br>
                成人の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/1/8<br>
                建国記念の日 &nbsp;&nbsp; 2024/2/11<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/2/12<br>
                天皇誕生日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/2/23<br>
                春分の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/3/20<br>
                昭和の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/4/29<br>
                憲法記念日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/5/3<br>
                みどりの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/5/4<br>
                こどもの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/5/5<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/5/6<br>
                海の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/7/15<br>
                山の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/8/11<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/8/12<br>
                敬老の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/9/16<br>
                秋分の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/9/22<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/9/23<br>
                スポーツの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/10/14<br>
                文化の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/11/3<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2024/11/4<br>
                勤労感謝の日 &nbsp;&nbsp; 2024/11/23<br><br>
                
                元日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/1/1<br>
                成人の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/1/13<br>
                建国記念の日 &nbsp;&nbsp; 2025/2/11<br>
                天皇誕生日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/2/23<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/2/24<br>
                春分の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/3/20<br>
                昭和の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/4/29<br>
                憲法記念日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/5/3<br>
                みどりの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/5/4<br>
                こどもの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/5/5<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/5/6<br>
                海の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/7/21<br>
                山の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/8/11<br>
                敬老の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/9/15<br>
                秋分の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/9/23<br>
                スポーツの日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/10/13<br>
                文化の日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/11/3<br>
                勤労感謝の日 &nbsp;&nbsp; 2025/11/23<br>
                休日 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2025/11/24<br>
            </blockquote>
        </div>
    </section>

    <section id="request-step8">
        <h2>ステップ8: カレンダーの祝日を赤にする</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText8')">コピーする</button>
            <blockquote id="requestText8">
                エクセルで「Sheet1」にカレンダーを作成しています。カレンダーは以下の前提で作成されています。
                <ol>
                    <li>セルA1には「YYYY/MM」の形式で現在の年月が表示されており、A1からG1までが結合されています。</li>
                    <li>セルA2からG2には曜日（日、月、火、水、木、金、土）が表示されています。</li>
                    <li>カレンダーの日付はセルA3からG8に配置されており、これらの日付は数値のみで表示されています（例：1, 2, 3など）。</li>
                </ol>
                また、「祝日」という名前のシートがあり、祝日リストは以下の形式で入力されています。
                <ol>
                    <li>1行目はヘッダーです。</li>
                    <li>A列には祝日の名前が入力されています。</li>
                    <li>B列には「YYYY/MM/DD」形式で日付が入力されています。</li>
                </ol>
                以下の手順でカレンダーの日付を祝日リストの日付と比較し、一致する場合は赤文字にするマクロ「MarkHolidaysInRed」を作成してください。
                <ol>
                    <li>シート「Sheet1」と「祝日」の参照を取得してください。</li>
                    <li>セルA1の値を「YYYY/MM」形式から年と月を取得してください（例：「2023/05」→「2023」と「5」）。</li>
                    <li>カレンダーの日付範囲（セルA3からG8）をループし、各日付を現在の年月と組み合わせてDateSerial関数で完全な日付に変換してください。</li>
                    <li>祝日リストの日付範囲（セルB2から最後の行まで）をループし、各日付を比較してください。</li>
                    <li>一致する日付が見つかった場合、そのカレンダーの日付を赤文字にしてください。</li>
                </ol>
                <b>注意点：</b>
                <ol>
                    <li>カレンダーの日付を変換する際、Year関数とMonth関数を使用してセルA1の値から年と月を取得してください。</li>
                    <li>For Eachループを使用する際、変数をセルオブジェクトに適したものに設定してください（例：calendarCell、holidayCellはそれぞれRangeオブジェクト内の個々のセルを指します）。</li>
                    <li>日付の比較にはDateSerial関数とDateValue関数を使用してください。</li>
                </ol>
                <b>具体的なコードの構造は以下の通りです：</b>
                <ol>
                    <li>シートと範囲の設定。</li>
                    <li>セルA1の値から年月を取得し、完全な日付を生成。</li>
                    <li>カレンダーの日付範囲をループし、各日付を完全な日付に変換。</li>
                    <li>祝日リストをループし、日付を比較。</li>
                    <li>一致する場合、フォントの色を赤に設定。</li>
                </ol>
                この構造に従ってマクロを作成してください。
            </blockquote>
        </div>
    </section>

    <section id="request-step9">
        <h2>ステップ9: 初期化してカレンダーを作成する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText9')">コピーする</button>
            <blockquote id="requestText9">
                エクセルで「Sheet1」にカレンダーを作成しています。シートを初期状態に戻してからカレンダーを作成するためのVBAマクロを作成したいと考えています。具体的な要件は以下の通りです：
                <ol>
                    <li>シート1の内容、書式、結合をクリアする。</li>
                    <li>カレンダーを作成するための各ステップを順に呼び出す。</li>
                </ol>
                各ステップは既に用意されており、以下の順番で呼び出します：
                <ul>
                    <li>DisplayCurrentYearMonth</li>
                    <li>SetCalendarHeaders</li>
                    <li>DrawCalendarBorders</li>
                    <li>DisplayFirstDay</li>
                    <li>AddRemainingDays</li>
                    <li>ColorWeekends</li>
                    <li>CreateHolidaySheet</li>
                    <li>MarkHolidaysInRed</li>
                </ul>
                これらのステップをまとめて呼び出すマクロを「InitializeAndCreateCalendar」という名前で作成したいです。コードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step10">
        <h2>ステップ10: ダブルクリックでセルの色を変更する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText10')">コピーする</button>
            <blockquote id="requestText10">
                エクセルで「Sheet1」にカレンダーを作成しています。各日付セルをダブルクリックすることでセルの色を変更できるようにしたいと考えています。ダブルクリックしたセルの塗りつぶし色を赤にし、再度ダブルクリックすると元の状態に戻るようにしたいです。カレンダーの構成は以下の通りです：
                <ol>
                    <li>セルA1には「YYYY/MM」の形式で現在の年月が表示されており、A1からG1までが結合されています。</li>
                    <li>セルA2からG2には曜日（日、月、火、水、木、金、土）が表示されています。</li>
                    <li>カレンダーの日付はセルA3からG8に配置されており、これらの日付は数値のみで表示されています（例：1, 2, 3など）。</li>
                </ol>
                <b>注意点：</b>
                <ul>
                    <li>日付が入力されていないセルは色が変わらないようにする。</li>
                    <li>ワークシートのコードとして実装する。</li>
                    <li>ダブルクリックでセルが編集状態になるのを防ぐため、ダブルクリックイベントをキャンセルする。</li>
                </ul>
                この機能を実現するためのコードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step11">
        <h2>ステップ11: メンバーリストの作成</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText11')">コピーする</button>
            <blockquote id="requestText11">
                エクセルで「管理用」というシートに、メンバーリストを作成してほしいです。以下の要件を満たすマクロを「CreateMemberList」という名前で作成してください。
                <ol>
                    <li>A列に通し番号、B列に架空の日本人スタッフメンバー20人分の氏名（フルネーム、苗字と名前の間に半角スペースを入れる）、C列に休み希望を入力できるようにしてください。</li>
                    <li>1行目をヘッダーとして、「No」「氏名」「休み希望」のタイトルを設定し、黄色に塗りつぶし、太字にしてください。</li>
                    <li>シートが既に存在する場合、そのシートを削除せずに、内容と書式をクリアしてから新しいデータを入力してください。具体的には、ws.Cells.Clearとws.Cells.ClearFormatsを使用してください。</li>
                    <li>全体を中央揃えにしてください。具体的には、A列、B列、C列の全てのセルを中央揃えにしてください。</li>
                    <li>各セルに枠線を付けてください。具体的には、A1からC21までの全てのセルに枠線を設定してください。</li>
                    <li>列の幅をセル内容に合わせて自動調整してください。具体的には、A1からC21の範囲に対してAutoFitメソッドを使用してください。</li>
                </ol>
                20人分の架空の日本人名前を以下のリストから使用してください：
                <ul>
                    <li>田中 太郎</li>
                    <li>山田 花子</li>
                    <li>佐藤 雄大</li>
                    <li>鈴木 美咲</li>
                    <li>高橋 健太</li>
                    <li>伊藤 まどか</li>
                    <li>渡辺 拓也</li>
                    <li>斎藤 亜美</li>
                    <li>小林 健介</li>
                    <li>中村 みゆき</li>
                    <li>加藤 大輔</li>
                    <li>吉田 美和</li>
                    <li>山口 剛</li>
                    <li>林 さくら</li>
                    <li>清水 明美</li>
                    <li>阿部 健太郎</li>
                    <li>森田 未来</li>
                    <li>岡田 優子</li>
                    <li>橋本 貴之</li>
                    <li>山崎 瞳</li>
                </ul>
                以下の骨子に従ってコードを作成してください：
                <ol>
                    <li>シートの作成または取得</li>
                    <li>ヘッダーの設定</li>
                    <li>架空のメンバー名のリストを使用してデータを入力</li>
                    <li>セルの枠線の設定</li>
                    <li>列の幅の自動調整</li>
                </ol>
                このシートを作成するためのコードを教えてください。
            </blockquote>
        </div>
    </section>

    <section id="request-step12">
        <h2>ステップ12: メンバー名取得とカレンダー更新</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#requestText12')">コピーする</button>
            <blockquote id="requestText12">
                「管理用」シートのB列、B2以下最下段までのセルをダブルクリックしたときに実行される、「管理用」シート用のコードが欲しいです。ダブルクリックされたセルのメンバー名を取得し、既存のInitializeAndCreateCalendarマクロを呼び出してください。カレンダーがSheet1に作成されるので、そのA1セルの内容を、「元の内容 + 半角スペース + メンバー名」という形式で更新し、最後にSheet1をアクティブにしてください。引数は渡さないで実装してください。
                以上の機能を実装したコードを教えてもらえますか。
            </blockquote>
        </div>
    </section>
    
    <!-- コード例セクション -->
    <section id="code-step1">
        <h2>ステップ1: セルA1に現在の年月を表示する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample1')">コピーする</button>
            <pre id="codeExample1">
Sub DisplayCurrentYearMonth()
    Dim ws As Worksheet
    Dim currentYear As Integer
    Dim currentMonth As Integer

    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' 現在の年と月を取得
    currentYear = Year(Date)
    currentMonth = Month(Date)

    ' セルA1からG1を結合して現在の年月を表示（YYYY/MM形式）
    With ws.Range("A1:G1")
        .Merge
        .Value = currentYear & "/" & Format(currentMonth, "00")
        .HorizontalAlignment = xlCenter
    End With
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step2">
        <h2>ステップ2: カレンダーの曜日ヘッダーを設定する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample2')">コピーする</button>
            <pre id="codeExample2">
Sub SetCalendarHeaders()
    Dim ws As Worksheet
    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")
    ' 曜日ヘッダーをセルA2からG2に設定
    ws.Range("A2").Value = "日"
    ws.Range("B2").Value = "月"
    ws.Range("C2").Value = "火"
    ws.Range("D2").Value = "水"
    ws.Range("E2").Value = "木"
    ws.Range("F2").Value = "金"
    ws.Range("G2").Value = "土"
    ' 文字を中央揃えに設定
    ws.Range("A2:G2").HorizontalAlignment = xlCenter
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step3">
        <h2>ステップ3: カレンダーの枠線を設定する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample3')">コピーする</button>
            <pre id="codeExample3">
Sub DrawCalendarBorders()
    Dim ws As Worksheet
    Dim calendarRange As Range

    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' カレンダー範囲を設定
    Set calendarRange = ws.Range("A2:G8")

    ' 外枠の設定
    With calendarRange.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With

    With calendarRange.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With

    With calendarRange.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With

    With calendarRange.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With

    ' 内側の枠線の設定
    With calendarRange.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With

    With calendarRange.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 0
    End With
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step4">
        <h2>ステップ4: 1日目をカレンダーに表示する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample4')">コピーする</button>
            <pre id="codeExample4">
Sub DisplayFirstDay()
    Dim ws As Worksheet
    Dim startDate As Date
    Dim firstDayColumn As Integer

    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' 現在の年月の1日目を取得
    startDate = DateSerial(Year(Date), Month(Date), 1)

    ' 1日目の曜日を取得し、対応する列を計算
    firstDayColumn = Weekday(startDate, vbSunday)

    ' 1日目を表示
    ws.Cells(3, firstDayColumn).Value = 1

    ' 文字を中央揃えに設定
    ws.Cells(3, firstDayColumn).HorizontalAlignment = xlCenter
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step5">
        <h2>ステップ5: 2日目以降を追加する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample5')">コピーする</button>
            <pre id="codeExample5">
Sub AddRemainingDays()
    Dim ws As Worksheet
    Dim startDate As Date
    Dim currentDate As Date
    Dim endDate As Date
    Dim currentRow As Integer
    Dim currentColumn As Integer

    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' 1日目の日付を取得
    startDate = DateSerial(Year(Date), Month(Date), 1)
    currentDate = startDate + 1

    ' 月の最終日を取得
    endDate = DateSerial(Year(Date), Month(Date) + 1, 0)

    ' 1日目の表示位置を計算
    currentRow = 3
    currentColumn = Weekday(startDate, vbSunday)

    ' 2日目以降を表示
    Do While currentDate <= endDate
        currentColumn = currentColumn + 1

        ' 次の行に移動するか確認
        If currentColumn > 7 Then
            currentColumn = 1
            currentRow = currentRow + 1
        End If

        ws.Cells(currentRow, currentColumn).Value = Day(currentDate)
        ws.Cells(currentRow, currentColumn).HorizontalAlignment = xlCenter

        ' 次の日付へ
        currentDate = currentDate + 1
    Loop
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step6">
        <h2>ステップ6: 土曜日を青、日曜日を赤にする</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample6')">コピーする</button>
            <pre id="codeExample6">
Sub ColorWeekends()
    Dim ws As Worksheet
    Dim cell As Range
    Dim startDate As Date
    Dim endDate As Date
    Dim currentDate As Date
    Dim firstDayColumn As Integer
    Dim currentRow As Integer
    Dim currentColumn As Integer

    ' Sheet1を取得
    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' 曜日ヘッダーの色設定
    ws.Range("A2").Font.Color = RGB(255, 0, 0) ' 日曜日 赤色
    ws.Range("G2").Font.Color = RGB(0, 0, 255) ' 土曜日 青色

    ' 1日目の日付を取得
    startDate = DateSerial(Year(Date), Month(Date), 1)
    endDate = DateSerial(Year(Date), Month(Date) + 1, 0)
    firstDayColumn = Weekday(startDate, vbSunday)

    ' 各日付をループ
    currentDate = startDate
    currentRow = 3
    currentColumn = firstDayColumn

    Do While currentDate <= endDate
        Set cell = ws.Cells(currentRow, currentColumn)

        ' 土曜日と日曜日の色設定
        If Weekday(currentDate, vbSunday) = vbSunday Then
            cell.Font.Color = RGB(255, 0, 0) ' 赤色
        ElseIf Weekday(currentDate, vbSunday) = vbSaturday Then
            cell.Font.Color = RGB(0, 0, 255) ' 青色
        End If

        ' 次の日付へ
        currentDate = currentDate + 1
        currentColumn = currentColumn + 1

        ' 次の行に移動するか確認
        If currentColumn > 7 Then
            currentColumn = 1
            currentRow = currentRow + 1
        End If
    Loop
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step7">
        <h2>ステップ7: 祝日というシートに今年の祝日リストを書く</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample7')">コピーする</button>
            <pre id="codeExample7">
Sub CreateHolidaySheet()
    Dim ws As Worksheet
    Dim holidayList As Variant
    Dim i As Long
    
    ' 祝日リストのデータ
    holidayList = Array( _
        Array("祝日名", "日付"), _
        Array("元日", "2024/1/1"), Array("成人の日", "2024/1/8"), _
        Array("建国記念の日", "2024/2/11"), Array("休日", "2024/2/12"), _
        Array("天皇誕生日", "2024/2/23"), Array("春分の日", "2024/3/20"), _
        Array("昭和の日", "2024/4/29"), Array("憲法記念日", "2024/5/3"), _
        Array("みどりの日", "2024/5/4"), Array("こどもの日", "2024/5/5"), _
        Array("休日", "2024/5/6"), Array("海の日", "2024/7/15"), _
        Array("山の日", "2024/8/11"), Array("休日", "2024/8/12"), _
        Array("敬老の日", "2024/9/16"), Array("秋分の日", "2024/9/22"), _
        Array("休日", "2024/9/23"), Array("スポーツの日", "2024/10/14"), _
        Array("文化の日", "2024/11/3"), Array("休日", "2024/11/4"), _
        Array("勤労感謝の日", "2024/11/23"), Array("元日", "2025/1/1"), _
        Array("成人の日", "2025/1/13"), Array("建国記念の日", "2025/2/11"), _
        Array("天皇誕生日", "2025/2/23"), Array("休日", "2025/2/24"), _
        Array("春分の日", "2025/3/20"), Array("昭和の日", "2025/4/29"), _
        Array("憲法記念日", "2025/5/3"), Array("みどりの日", "2025/5/4"), _
        Array("こどもの日", "2025/5/5"), Array("休日", "2025/5/6"), _
        Array("海の日", "2025/7/21"), Array("山の日", "2025/8/11"), _
        Array("敬老の日", "2025/9/15"), Array("秋分の日", "2025/9/23"), _
        Array("スポーツの日", "2025/10/13"), Array("文化の日", "2025/11/3"), _
        Array("勤労感謝の日", "2025/11/23"), Array("休日", "2025/11/24"))

    ' 祝日シートの存在確認
    On Error Resume Next
    Set ws = ThisWorkbook.Worksheets("祝日")
    On Error GoTo 0
    
    ' シートが存在しない場合は作成
    If ws Is Nothing Then
        Set ws = ThisWorkbook.Worksheets.Add
        ws.Name = "祝日"
    Else
        ' シートの内容とフォーマットをクリア
        ws.Cells.Clear
        ws.Cells.ClearFormats
    End If

    ' 祝日リストをシートに書き込む
    For i = LBound(holidayList) To UBound(holidayList)
        ws.Cells(i + 1, 1).Value = holidayList(i)(0)
        ws.Cells(i + 1, 2).Value = holidayList(i)(1)
    Next i

    ' 書式設定
    With ws.Range("A1:B" & UBound(holidayList) + 1)
        .Borders.LineStyle = xlContinuous
        .HorizontalAlignment = xlCenter
        .Columns("A:B").AutoFit
    End With

    ' ヘッダーのみ黄色塗りつぶし
    With ws.Range("A1:B1")
        .Interior.Color = RGB(255, 255, 0)
    End With
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step8">
        <h2>ステップ8: カレンダーの祝日を赤にする</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample8')">コピーする</button>
            <pre id="codeExample8">
Sub MarkHolidaysInRed()
    Dim calendarSheet As Worksheet
    Dim holidaySheet As Worksheet
    Dim calendarRange As Range
    Dim holidayRange As Range
    Dim calendarCell As Range
    Dim holidayCell As Range
    Dim currentYear As Integer
    Dim currentMonth As Integer
    Dim currentDate As Date
    Dim holidayDate As Date

    ' シートと範囲の設定
    Set calendarSheet = ThisWorkbook.Sheets("Sheet1")
    Set holidaySheet = ThisWorkbook.Sheets("祝日")
    Set calendarRange = calendarSheet.Range("A3:G8")
    Set holidayRange = holidaySheet.Range("B2", holidaySheet.Cells(holidaySheet.Rows.Count, "B").End(xlUp))

    ' セルA1の値から年月を取得し、完全な日付を生成
    currentYear = CInt(Left(calendarSheet.Range("A1").Value, 4))
    currentMonth = CInt(Right(calendarSheet.Range("A1").Value, 2))

    ' カレンダーの日付範囲をループし、各日付を完全な日付に変換
    For Each calendarCell In calendarRange
        If IsNumeric(calendarCell.Value) Then
            currentDate = DateSerial(currentYear, currentMonth, calendarCell.Value)

            ' 祝日リストをループし、日付を比較
            For Each holidayCell In holidayRange
                If IsDate(holidayCell.Value) Then
                    holidayDate = DateValue(holidayCell.Value)
                    ' 一致する場合、フォントの色を赤に設定
                    If currentDate = holidayDate Then
                        calendarCell.Font.Color = RGB(255, 0, 0) ' 赤色
                        Exit For ' 一致したらループを抜ける
                    End If
                End If
            Next holidayCell
        End If
    Next calendarCell
End Sub
            </pre>
        </div>
    </section>

    <section id="code-step9">
        <h2>ステップ9: 初期化してカレンダーを作成する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample9')">コピーする</button>
            <pre id="codeExample9">
    Sub InitializeAndCreateCalendar()
        ' シート1の内容、書式、結合をクリア
        Dim ws As Worksheet
        Set ws = ThisWorkbook.Sheets("Sheet1")
        
        ' セルの内容をクリア
        ws.Cells.Clear
        
        ' 書式のクリア
        ws.Cells.ClearFormats
        
        ' 結合の解除
        ws.Cells.UnMerge
        
        ' カレンダー作成の各ステップを順に呼び出す
        Call DisplayCurrentYearMonth
        Call SetCalendarHeaders
        Call DrawCalendarBorders
        Call DisplayFirstDay
        Call AddRemainingDays
        Call ColorWeekends
        Call CreateHolidaySheet
        Call MarkHolidaysInRed
    End Sub
            </pre>
        </div>
    </section>
    
    <section id="code-step10">
        <h2>ステップ10: ダブルクリックでセルの色を変更する</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample10')">コピーする</button>
            <pre id="codeExample10">
    Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
        Dim rngCalendar As Range
    
        ' カレンダー範囲を指定（例：A3:G8）
        Set rngCalendar = Range("A3:G8")
    
        ' カレンダー内のセルがダブルクリックされた場合
        If Not Intersect(Target, rngCalendar) Is Nothing Then
            ' クリックされたセルが空白でない場合のみ実行
            If Target.Value <> "" Then
                ' 色を切り替え
                If Target.Interior.Color = RGB(255, 0, 0) Then
                    Target.Interior.ColorIndex = xlNone ' 色を元に戻す
                Else
                    Target.Interior.Color = RGB(255, 0, 0) ' 赤く塗りつぶす
                End If
                Cancel = True ' ダブルクリックイベントをキャンセル
            End If
        End If
    End Sub
            </pre>
        </div>
    </section>

    <section id="code-step11">
        <h2>ステップ11: メンバーリストの作成</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample11')">コピーする</button>
            <pre id="codeExample11">
    Sub CreateMemberList()
        Dim ws As Worksheet
        Dim i As Integer
        Dim memberNames As Variant
        
        ' メンバー名のリスト
        memberNames = Array("田中 太郎", "山田 花子", "佐藤 雄大", "鈴木 美咲", "高橋 健太", _
                            "伊藤 まどか", "渡辺 拓也", "斎藤 亜美", "小林 健介", "中村 みゆき", _
                            "加藤 大輔", "吉田 美和", "山口 剛", "林 さくら", "清水 明美", _
                            "阿部 健太郎", "森田 未来", "岡田 優子", "橋本 貴之", "山崎 瞳")
        
        ' シートの取得または新規作成
        On Error Resume Next
        Set ws = ThisWorkbook.Sheets("管理用")
        On Error GoTo 0
        If ws Is Nothing Then
            Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
            ws.Name = "管理用"
        Else
            ws.Cells.Clear
            ws.Cells.ClearFormats
        End If
        
        ' ヘッダーの設定
        With ws.Range("A1:C1")
            .Value = Array("No", "氏名", "休み希望")
            .Font.Bold = True
            .Interior.Color = RGB(255, 255, 0) ' 黄色に塗りつぶし
            .HorizontalAlignment = xlCenter
        End With
        
        ' メンバーリストの設定
        For i = 1 To 20
            ws.Cells(i + 1, 1).Value = i ' 通し番号
            ws.Cells(i + 1, 2).Value = memberNames(i - 1) ' 氏名
            ws.Cells(i + 1, 3).Value = "" ' 休み希望
        Next i
        
        ' 全体を中央揃えに設定
        ws.Range("A2:C21").HorizontalAlignment = xlCenter
        
        ' セルに枠線を設定
        ws.Range("A1:C21").Borders.LineStyle = xlContinuous
        
        ' 列の幅を自動調整
        ws.Columns("A:C").AutoFit
    End Sub
            </pre>
        </div>
    </section>

    <section id="code-step12">
        <h2>ステップ12: メンバー名取得とカレンダー更新</h2>
        <div class="code-container">
            <button class="copy-button" onclick="copyToClipboard('#codeExample12')">コピーする</button>
            <pre id="codeExample12">
    Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
        ' シート1のオブジェクトを取得
        Dim ws As Worksheet
        Set ws = ThisWorkbook.Sheets("Sheet1")
        
        ' 管理用シートのB列（B2以下）をチェック
        If Not Intersect(Target, Me.Range("B2:B" & Me.Rows.Count)) Is Nothing Then
            ' メンバー名を取得
            Dim memberName As String
            memberName = Target.Value
            
            ' カレンダーを作成
            InitializeAndCreateCalendar
            
            ' A1セルの内容を更新
            ws.Range("A1").Value = ws.Range("A1").Value & " " & memberName
            
            ' Sheet1をアクティブにする
            ws.Activate
            
            ' ダブルクリックによる編集をキャンセル
            Cancel = True
        End If
    End Sub
            </pre>
        </div>
    </section>
    
    <script>
        function copyToClipboard(element) {
            var temp = document.createElement('textarea');
            temp.value = document.querySelector(element).innerText;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            alert('コピーしました!');
        }
    </script>
</body>
</html>
