<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>依頼文</title>
</head>
<body>
    <h1>エクセルでカレンダーを作成するための依頼文</h1>
    <p>エクセルで「Sheet1」にカレンダーを作成しています。カレンダーは以下の前提で作成されています。</p>
    <ol>
        <li>セルA1には「YYYY/MM」の形式で現在の年月が表示されており、A1からG1までが結合されています。</li>
        <li>セルA2からG2には曜日（日、月、火、水、木、金、土）が表示されています。</li>
        <li>カレンダーの日付はセルA3からG8に配置されており、これらの日付は数値のみで表示されています（例：1, 2, 3など）。</li>
    </ol>
    <p>また、「祝日」という名前のシートがあり、祝日リストは以下の形式で入力されています。</p>
    <ol>
        <li>1行目はヘッダーです。</li>
        <li>A列には祝日の名前が入力されています。</li>
        <li>B列には「YYYY/MM/DD」形式で日付が入力されています。</li>
    </ol>
    <p>このカレンダーに対して、以下の機能を持つマクロを作成してください。</p>
    <h2>機能要件</h2>
    <ol>
        <li>ユーザーに月を入力させ、その月のカレンダーを表示する。</li>
        <li>入力された月をセルA1の「YYYY/MM」形式の値に反映する。</li>
        <li>カレンダーの日付が配置されているセル範囲（A3からG8）の内容をクリアし、フォント色を黒にリセットし、中央揃えに設定する。</li>
        <li>指定された月の1日を適切な曜日のセルに配置し、その月の全日付を表示する。月の最初の日を正しい位置に配置する。</li>
        <li>日曜日は赤色、土曜日は青色で表示する。</li>
        <li>祝日リストとカレンダーの日付を比較し、一致する日付を赤色で表示する。</li>
    </ol>
    <h2>ロジックの大筋</h2>
    <ol>
        <li>シート「Sheet1」と「祝日」を参照する。</li>
        <li>ユーザーに月を入力させ、入力が無効な場合はエラーメッセージを表示して終了する。</li>
        <li>入力された月と現在の年をセルA1に「YYYY/MM」形式で表示する。</li>
        <li>カレンダーの日付が配置されているセル範囲（A3からG8）の内容をクリアし、フォント色を黒にリセットし、中央揃えに設定する。</li>
        <li>入力された月の最初の日の曜日を取得し、その位置から1日を配置し、月末までの日付を順に入力する。最初の日の曜日に基づいて正しいセルに1日を配置する。</li>
        <li>日曜日を赤色、土曜日を青色に設定する。</li>
        <li>祝日リストの各セルをループし、無効な日付を除外してカレンダーの日付と一致する祝日を赤色に設定する。</li>
    </ol>
</body>
</html>
